{"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://gitlab.kilic.dev/docker/vizier/pipe/vizier-config","$defs":{"JsonDuration":{"type":"string"},"VizierChmod":{"properties":{"file":{"oneOf":[{"type":"string"}]},"dir":{"oneOf":[{"type":"string"}]}},"additionalProperties":false,"type":"object"},"VizierChown":{"properties":{"user":{"oneOf":[{"type":"string"}]},"group":{"oneOf":[{"type":"string"}]}},"additionalProperties":false,"type":"object","required":["user"]},"VizierConfig":{"properties":{"steps":{"items":{"$ref":"#/$defs/VizierStep"},"type":"array"}},"additionalProperties":false,"type":"object","required":["steps"]},"VizierStep":{"properties":{"name":{"type":"string"},"commands":{"items":{"$ref":"#/$defs/VizierStepCommand"},"type":"array"},"permissions":{"items":{"$ref":"#/$defs/VizierStepPermission"},"type":"array"},"templates":{"items":{"$ref":"#/$defs/VizierStepTemplate"},"type":"array"},"delay":{"$ref":"#/$defs/JsonDuration","type":"string"},"background":{"type":"boolean"},"parallel":{"type":"boolean"},"log":{"$ref":"#/$defs/VizierStepLogLevel"}},"additionalProperties":false,"type":"object"},"VizierStepCommand":{"properties":{"name":{"type":"string"},"cwd":{"type":"string"},"command":{"type":"string"},"script":{"$ref":"#/$defs/VizierStepCommandScript"},"retry":{"$ref":"#/$defs/VizierStepCommandRetry"},"environment":{"additionalProperties":{"type":"string"},"type":"object"},"runAs":{"$ref":"#/$defs/VizierStepCommandRunAs"},"health":{"$ref":"#/$defs/VizierStepCommandHealth"},"parallel":{"type":"boolean"},"log":{"$ref":"#/$defs/VizierStepCommandLogLevel"}},"additionalProperties":false,"type":"object","required":["command"]},"VizierStepCommandHealth":{"properties":{"ensureIsAlive":{"type":"boolean"},"ignoreError":{"type":"boolean"}},"additionalProperties":false,"type":"object"},"VizierStepCommandLogLevel":{"properties":{"stdout":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]},"stderr":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]},"lifetime":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]},"permissions":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]}},"additionalProperties":false,"type":"object"},"VizierStepCommandRetry":{"properties":{"retries":{"type":"integer"},"always":{"type":"boolean"},"delay":{"$ref":"#/$defs/JsonDuration","type":"string"}},"additionalProperties":false,"type":"object"},"VizierStepCommandRunAs":{"properties":{"user":{"oneOf":[{"type":"string"}]},"group":{"oneOf":[{"type":"string"}]}},"additionalProperties":false,"type":"object","required":["user"]},"VizierStepCommandScript":{"properties":{"inline":{"type":"string"},"file":{"type":"string"},"ctx":true},"additionalProperties":false,"type":"object"},"VizierStepLogLevel":{"properties":{"delay":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]},"background":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]}},"additionalProperties":false,"type":"object"},"VizierStepPermission":{"properties":{"path":{"type":"string"},"chown":{"$ref":"#/$defs/VizierChown"},"chmod":{"$ref":"#/$defs/VizierChmod"},"recursive":{"type":"boolean"},"parallel":{"type":"boolean"},"log":{"$ref":"#/$defs/VizierStepPermissionLogLevel"}},"additionalProperties":false,"type":"object","required":["path"]},"VizierStepPermissionLogLevel":{"properties":{"chown":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]},"chmod":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]}},"additionalProperties":false,"type":"object"},"VizierStepTemplate":{"properties":{"inline":{"type":"string"},"input":{"type":"string"},"output":{"type":"string"},"ctx":true,"chmod":{"$ref":"#/$defs/VizierChmod"},"chown":{"$ref":"#/$defs/VizierChown"},"parallel":{"type":"boolean"},"log":{"$ref":"#/$defs/VizierStepTemplateLogLevel"}},"additionalProperties":false,"type":"object","required":["output"]},"VizierStepTemplateLogLevel":{"properties":{"generation":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]},"ctx":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]},"chown":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]},"chmod":{"type":"string","enum":["fatal","error","warn","info","debug","trace"]}},"additionalProperties":false,"type":"object"}},"allOf":[{"$ref":"#/$defs/VizierConfig"}]}